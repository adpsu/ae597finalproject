import pandas as pd

# Load the original CSV file
df = pd.read_csv('your_file.csv')

# Filter where total_sales != 0
filtered_sales_df = df[df['total_sales'] != 0]

# Group by year and Tech, then count the rows
grouped_sales_df = filtered_sales_df.groupby(['year', 'Tech']).size().reset_index(name='count')

# Save the result to a new CSV file
grouped_sales_df.to_csv('filtered_total_sales.csv', index=False)

# Additional filter where total_sales != 0 and MSRP != 0
filtered_sales_msrp_df = df[(df['total_sales'] != 0) & (df['MSRP'] != 0)]

# Group by year and Tech, then count the rows
grouped_sales_msrp_df = filtered_sales_msrp_df.groupby(['year', 'Tech']).size().reset_index(name='count')

# Save the result to another new CSV file
grouped_sales_msrp_df.to_csv('filtered_total_sales_msrp.csv', index=False)
