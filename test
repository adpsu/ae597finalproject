import pandas as pd

# Load the data
df = pd.read_csv("house.csv")

# State code mapping (shortened for brevity)
state_code_mapping = {
    "AL": "01", "AK": "02", "AZ": "04", "AR": "05", "CA": "06",
    "CO": "08", "CT": "09", "DE": "10", "FL": "12", "GA": "13",
    "HI": "15", "ID": "16", "IL": "17", "IN": "18", "IA": "19",
    "KS": "20", "KY": "21", "LA": "22", "ME": "23", "MD": "24",
    "MA": "25", "MI": "26", "MN": "27", "MS": "28", "MO": "29",
    "MT": "30", "NE": "31", "NV": "32", "NH": "33", "NJ": "34",
    "NM": "35", "NY": "36", "NC": "37", "ND": "38", "OH": "39",
    "OK": "40", "OR": "41", "PA": "42", "RI": "44", "SC": "45",
    "SD": "46", "TN": "47", "TX": "48", "UT": "49", "VT": "50",
    "VA": "51", "WA": "53", "WV": "54", "WI": "55", "WY": "56"
}


# Map state codes to numeric codes
df['state_numeric'] = df['state'].map(state_code_mapping)

# Aggregate by state_numeric
agg_state = df.groupby('state_numeric')['cs.hh'].sum().reset_index()
agg_state.columns = ['state_numeric', 'total_cs.hh_state']

# Aggregate by county
agg_county = df.groupby(['state_numeric', 'county'])['cs.hh'].sum().reset_index()
agg_county.columns = ['state_numeric', 'county', 'total_cs.hh_county']

# Save the aggregated DataFrames
agg_state.to_csv("agg_state.csv", index=False)
agg_county.to_csv("agg_county.csv", index=False)
