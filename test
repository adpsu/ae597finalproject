from pyspark.sql import SparkSession

# Create a Spark session
spark = SparkSession.builder \
    .appName("Load Parquet Files") \
    .getOrCreate()

# Define the base directory
base_directory = "/path/to/model_year=2050/"

# Load Parquet files from directories that match the pattern
# The '*' wildcard matches any sequence of characters
df = spark.read.parquet(base_directory + "subsector=Personal_LDV+*/metric=*/")

# Show the DataFrame schema and a preview of the data
df.printSchema()
df.show()

# Stop the Spark session
spark.stop()
