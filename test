import pandas as pd

# Assuming df1 and df2 are already defined

# Convert all columns to numeric
for column in df1.columns:
    df1[column] = pd.to_numeric(df1[column], errors='coerce')
for column in df2.columns:
    df2[column] = pd.to_numeric(df2[column], errors='coerce')

# Merge the DataFrames on "county code"
merged_df = pd.merge(df1, df2, on="county code", how='outer', indicator=True)

# Print and drop unmerged rows
print("Rows that didn't merge successfully:")
print(merged_df[merged_df['_merge'] != 'both'])

# Keep only the successfully merged rows and drop the merge indicator column
merged_df = merged_df[merged_df['_merge'] == 'both'].drop(columns=['_merge'])

# Display the cleaned DataFrame
print("Cleaned Merged DataFrame:")
print(merged_df)
