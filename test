import pandas as pd

# Load the CSV file
df = pd.read_csv('path/to/your/file.csv')

# Group by year and baseModel and check if all Tech types have non-zero total_sales
grouped = df.groupby(['year', 'baseModel']).filter(lambda x: (x['total_sales'] != 0).all())

# Count unique rows of baseModel where total_sales of every type of Tech is != 0 for every year
count_unique_baseModel = grouped.groupby(['year', 'baseModel']).size().reset_index(name='count')

# Save to CSV
count_unique_baseModel.to_csv('count_unique_baseModel.csv', index=False)

# For the second CSV, filter out rows where MSRP is zero
df_non_zero_msrp = df[df['MSRP'] != 0]

# Group by year and baseModel and check if all Tech types have non-zero total_sales
grouped_non_zero_msrp = df_non_zero_msrp.groupby(['year', 'baseModel']).filter(lambda x: (x['total_sales'] != 0).all())

# Count unique rows of baseModel where total_sales of every type of Tech is != 0 for every year where MSRP != 0
count_unique_baseModel_non_zero_msrp = grouped_non_zero_msrp.groupby(['year', 'baseModel']).size().reset_index(name='count')

# Save to CSV
count_unique_baseModel_non_zero_msrp.to_csv('count_unique_baseModel_non_zero_msrp.csv', index=False)

print("CSV files have been created successfully.")
